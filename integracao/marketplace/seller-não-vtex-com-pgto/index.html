<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book VTEX Lab Docs -->
    <head>
        <!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Seller não VTEX c/ pagto | VTEX Lab Docs</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.1">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../../../integracao/marketplace/vtex-marketplace-switch/index.html" />
    
    
    <link rel="prev" href="../../../integracao/marketplace/seller-não-vtex/index.html" />
    

        <!-- head:end -->
    </head>
    <body>
        <!-- body:start -->
        
    <link rel="stylesheet" href="../../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../../gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
        
        <link rel="stylesheet" href="../../../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.css">
        
    
    
        <link rel="stylesheet" href="../../../styles/website.css">
    

        
    <div class="book" data-level="1.2.4" data-basepath="../../.." data-revision="Fri Mar 11 2016 16:24:11 GMT-0300 (Hora oficial do Brasil)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="integracao/index.html">
            
                
                    <a href="../../../integracao/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Integração
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="integracao/erp/index.html">
            
                
                    <a href="../../../integracao/erp/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        ERP
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="integracao/erp/catalogo-completo/index.html">
            
                
                    <a href="../../../integracao/erp/catalogo-completo/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.1.</b>
                        
                        Catálogo Completo
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="integracao/erp/catalogo-expresso/index.html">
            
                
                    <a href="../../../integracao/erp/catalogo-expresso/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.2.</b>
                        
                        Catálogo Expresso
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="integracao/erp/listas/index.html">
            
                
                    <a href="../../../integracao/erp/listas/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.3.</b>
                        
                        Listas
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="integracao/erp/pedido-e-tracking/index.html">
            
                
                    <a href="../../../integracao/erp/pedido-e-tracking/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.4.</b>
                        
                        Pedido e Tracking
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="integracao/marketplace/index.html">
            
                
                    <a href="../../../integracao/marketplace/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Marketplace
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="integracao/marketplace/canal-de-vendas-nao-vtex/index.html">
            
                
                    <a href="../../../integracao/marketplace/canal-de-vendas-nao-vtex/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.1.</b>
                        
                        Marketplace não VTEX
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="integracao/marketplace/canal-de-vendas-nao-vtex-com-pgto/index.html">
            
                
                    <a href="../../../integracao/marketplace/canal-de-vendas-nao-vtex-com-pgto/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.2.</b>
                        
                        Marketplace não VTEX c/ pagto
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="integracao/marketplace/seller-não-vtex/index.html">
            
                
                    <a href="../../../integracao/marketplace/seller-não-vtex/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.3.</b>
                        
                        Seller não VTEX
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="1.2.4" data-path="integracao/marketplace/seller-não-vtex-com-pgto/index.html">
            
                
                    <a href="../../../integracao/marketplace/seller-não-vtex-com-pgto/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.4.</b>
                        
                        Seller não VTEX c/ pagto
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="integracao/marketplace/vtex-marketplace-switch/index.html">
            
                
                    <a href="../../../integracao/marketplace/vtex-marketplace-switch/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.5.</b>
                        
                        VTEX Marketplace Switch - Beta
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="plugins/lib/latest/expiration/index.html">
            
                
                    <a href="../../../plugins/lib/latest/expiration/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Plugins
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="search/api/beta/search/index.html">
            
                
                    <a href="../../../search/api/beta/search/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Search
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="bridge/index.html">
            
                
                    <a href="../../../bridge/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Bridge
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="bridge/configuracoes-de-marketplace/index.html">
            
                
                    <a href="../../../bridge/configuracoes-de-marketplace/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Configurações de Marketplace
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="bridge/configuracoes-de-marketplace/b2w/index.html">
            
                
                    <a href="../../../bridge/configuracoes-de-marketplace/b2w/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.1.</b>
                        
                        B2W
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="bridge/configuracoes-de-marketplace/cnova/index.html">
            
                
                    <a href="../../../bridge/configuracoes-de-marketplace/cnova/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.2.</b>
                        
                        Cnova
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="bridge/configuracoes-de-marketplace/rakuten/index.html">
            
                
                    <a href="../../../bridge/configuracoes-de-marketplace/rakuten/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.3.</b>
                        
                        Rakuten
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="bridge/configuracoes-de-marketplace/buscape/index.html">
            
                
                    <a href="../../../bridge/configuracoes-de-marketplace/buscape/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.4.</b>
                        
                        Buscapé
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.1.5" data-path="bridge/configuracoes-de-marketplace/walmart/index.html">
            
                
                    <a href="../../../bridge/configuracoes-de-marketplace/walmart/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.5.</b>
                        
                        Walmart
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.1.6" data-path="bridge/configuracoes-de-marketplace/mercadolivre/index.html">
            
                
                    <a href="../../../bridge/configuracoes-de-marketplace/mercadolivre/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.6.</b>
                        
                        Mercado Livre
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.1.7" data-path="bridge/configuracoes-de-marketplace/csu/index.html">
            
                
                    <a href="../../../bridge/configuracoes-de-marketplace/csu/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.7.</b>
                        
                        CSU
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="bridge/interface-de-pedidos/index.html">
            
                
                    <a href="../../../bridge/interface-de-pedidos/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Interface de Pedidos
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="bridge/interface-de-produto/index.html">
            
                
                    <a href="../../../bridge/interface-de-produto/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Interface de Produtos
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="bridge/interface-de-tracking/index.html">
            
                
                    <a href="../../../bridge/interface-de-tracking/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Interface de Tracking
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="bridge/interface-de-preco/index.html">
            
                
                    <a href="../../../bridge/interface-de-preco/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Interface de Preço
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="bridge/interface-de-estoque/index.html">
            
                
                    <a href="../../../bridge/interface-de-estoque/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        Interface de Estoque
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="vtex.js/latest/index.html">
            
                
                    <a href="../../../vtex.js/latest/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        vtex.js
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="vtex.js/latest/checkout/index.html">
            
                
                    <a href="../../../vtex.js/latest/checkout/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Checkout
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="vtex.js/latest/checkout/order-form.html">
            
                
                    <a href="../../../vtex.js/latest/checkout/order-form.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.1.</b>
                        
                        OrderForm
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="vtex.js/latest/catalog/index.html">
            
                
                    <a href="../../../vtex.js/latest/catalog/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Catálogo
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../" >VTEX Lab Docs</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="seller-n%C3%A3o-vtex-vendendo-em-marketplace-hospedado-na-vtex-recebendo-pagamento"><a name="seller-n%C3%A3o-vtex-vendendo-em-marketplace-hospedado-na-vtex-recebendo-pagamento" class="plugin-anchor" href="#seller-n%C3%A3o-vtex-vendendo-em-marketplace-hospedado-na-vtex-recebendo-pagamento"><span class="fa fa-link"></span></a>Seller N&#xE3;o VTEX Vendendo em Marketplace Hospedado na VTEX Recebendo Pagamento</h2>
<p>Este documento tem por finalidade auxiliar na integra&#xE7;&#xE3;o de um <em>Seller</em> <strong>n&#xE3;o</strong> hospedado na plataforma VTEX para uma <em>Marketplace</em> hospedado na plataforma VTEX. <br>
Nesse modelo s&#xE3;o integrados produtos (<em>SKUs</em>), atualiza&#xE7;&#xE3;o de condi&#xE7;&#xE3;o comercial (pre&#xE7;o, estoque) de um SKU, al&#xE9;m de descida de pedido, dados de pagamento (para Sellers com PCI) e envio de autoriza&#xE7;&#xE3;o de despacho de pedido para o Seller.</p>
<blockquote>
<p><em>Seller</em> = Dono do produto, respons&#xE1;vel por fazer a entrega.<br>
<em>Marketplace</em> = Dono da vitrine, respons&#xE1;vel por expor e vender o SKU.<br>
<em>SKU</em> = Item a ser trocado e vendido entre Seller e Marketplace.<br></p>
</blockquote>
<h4 id="a%C3%A7%C3%B5es-que-dever%C3%A3o-ser-tomadas-pelo-seller-n%C3%A3o-hospedado-na-vtex-para-implementa%C3%A7%C3%A3o-da-integra%C3%A7%C3%A3o"><a name="a%C3%A7%C3%B5es-que-dever%C3%A3o-ser-tomadas-pelo-seller-n%C3%A3o-hospedado-na-vtex-para-implementa%C3%A7%C3%A3o-da-integra%C3%A7%C3%A3o" class="plugin-anchor" href="#a%C3%A7%C3%B5es-que-dever%C3%A3o-ser-tomadas-pelo-seller-n%C3%A3o-hospedado-na-vtex-para-implementa%C3%A7%C3%A3o-da-integra%C3%A7%C3%A3o"><span class="fa fa-link"></span></a>A&#xE7;&#xF5;es que dever&#xE3;o ser tomadas pelo Seller n&#xE3;o hospedado na VTEX para implementa&#xE7;&#xE3;o da integra&#xE7;&#xE3;o:</h4>
<ol>
<li><p>Implementar chamada de notifica&#xE7;&#xE3;o de mudan&#xE7;a de pre&#xE7;o e estoque - Seller vai chamar endpoint da VTEX. Toda vez que o SKU mudar o pre&#xE7;o e ou o estoque no Seller, o Seller tem que chamar esse endpoint da loja na VTEX, simplesmente comunicando a mudan&#xE7;a. Ao receber esse request o Marketplace vai buscar o pre&#xE7;o e estoque no Seller no m&#xE9;todo de consulta politica comercial que vamos falar mais abaixo.</p>
<p><em>exemplo da chamada:</em><br>
<code>https://sandboxintegracao.vtexcommercestable.com.br/api/catalog_system/pvt/skuSeller/changenotification/[idSeller]/[idskuSeller]</code></p>
<p><a href="#a1">Exemplo Completo: Enviar Notifica&#xE7;&#xE3;o de Mudan&#xE7;a de Pre&#xE7;o e Estoque de SKU</a></p>
</li>
<li><p>Implementar chamada de inser&#xE7;&#xE3;o de de sugest&#xE3;o de SKU -  Seller vai chamar endpoint da VTEX. Toda vez que o servi&#xE7;o de notifica&#xE7;&#xE3;o de mudan&#xE7;a retornar SKU <strong>n&#xE3;o</strong> encontrada (404), o Seller deve inserir a sugest&#xE3;o na loja da VTEX.</p>
<p><em>exemplo da chamada:</em><br>
<code>https://sandboxintegracao.vtexcommercestable.com.br/api/catalog_system/pvt/sku/SuggestionInsertUpdatev2</code></p>
<p><a href="#a2">Exemplo Completo: Enviar Sugest&#xE3;o de SKU</a></p>
</li>
<li><p>Implementar endpoint para consulta de politica comercial (pre&#xE7;o e estoque) - VTEX chama endpoint do Seller. A loja hospedada na VTEX usar&#xE1; esse m&#xE9;todo para buscar pre&#xE7;o e estoque no Seller tanto na indexa&#xE7;&#xE3;o (catalogar pre&#xE7;o e estoque), quanto na simula&#xE7;&#xE3;o de carrinho.</p>
<p><em>exemplo da chamada:</em><br>
<code>https://[seller].com.br/pvt/orderForms/simulation?sc=1&amp;an=mechantname</code></p>
<blockquote>
<p>NOTA:</p>
<blockquote>
<p>O m&#xE9;todo que consulta pre&#xE7;o e estoque e o m&#xE9;todo que simula carrinho s&#xE3;o os mesmos, mas por uma quest&#xE3;o de constru&#xE7;&#xE3;o de cache requer duas implementa&#xE7;&#xF5;es, uma sendo GET e outra POST.
Este &#xE9; um dos principais m&#xE9;todos da integra&#xE7;&#xE3;o, precisa ter performance e disponibilidade, pois tem impacto direto no fechamento da compra no Marketplace.</p>
</blockquote>
</blockquote>
<p><a href="#a3">Exemplo Completo: Consultar Pol&#xED;tica Comercial</a> <br>
<a href="#a4">Exemplo Completo: Simula&#xE7;&#xE3;o de Carrinho  - POST e GET</a> <br></p>
</li>
<li><p>Implementar endpoint para consultas de parcelamento - VTEX chama endpoint do Seller. A loja na VTEX ir&#xE1; usar esse endpoint para consultar os parcelamentos oferecidos pelo Seller.</p>
<p><em>exemplo da chamada:</em><br>
<code>https://[seller].com.br/pvt/installments/options?sc=1&amp;an=mechantname</code></p>
<blockquote>
<p>NOTA:</p>
<blockquote>
<p>Ah, tamb&#xE9;m precisa ter performance e disponibilidade, pois tem impacto direto no fechamento da compra no Marketplace.</p>
</blockquote>
</blockquote>
<p><a href="#a5">Exemplo Completo: Consultar Formas de Parcelamento no Seller</a></p>
</li>
<li><p>Implementar endpoint para receber um pedido - VTEX chama endpoint do Seller. A loja na VTEX ir&#xE1; usar esse endpoint para colocar um pedido no Seller.</p>
<p><em>exemplo da chamada:</em><br>
<code>https://[seller].com.br/pvt/orders?sc=1&amp;an=mechantname</code></p>
<p><a href="#a6">Exemplo Completo: Colocar um Pedido no Seller</a></p>
</li>
<li><p>Implementar endpoint para receber dados de pagamento - VTEX chama endpoint do Seller. A loja na VTEX ir&#xE1; usar esse endpoint para enviar o pagamento para o Seller</p>
<p><em>exemplo da chamada:</em><br>
<code>https://[seller].com.br/pvt/payments/?sc=1&amp;an=mechantname</code></p>
<blockquote>
<p>Nos dados de pagamento tem a url de retorno, onde o Seller ir&#xE1; notificar a loja na VTEX sobre o status do pagamento, ou seja, o Seller deve implementar rotina de informar status de pagamento na loja VTEX.</p>
</blockquote>
<p><a href="#a7">Exemplo Completo: Colocar um Pagamento no Seller</a></p>
</li>
<li><p>Implementar endpoint para fechar a transa&#xE7;&#xE3;o e autorizar despacho - VTEX chama endpoint do Seller. A loja na VTEX ir&#xE1; usar esse endpoint para avisar o Seller que j&#xE1; sabe do pagamento aprovado, e que o Seller j&#xE1; pode entregar com o pedido.</p>
<p><em>exemplo da chamada:</em><br>
<code>https://[seller].com.br/pvt/orders/[orderid]/fulfill?sc=1&amp;an=mechantname</code></p>
<p><a href="#a8">Exemplo Completo: Autorizar o Seller a Despachar o Pedido</a></p>
</li>
<li><p>Implementar endpoint para receber uma solicita&#xE7;&#xE3;o de cancelamento de pedido - VTEX chama endpoint do Seller. A loja na VTEX ir&#xE1; usar esse endpoint para solicitar o cancelamento de um pedido no Seller.</p>
<p><em>exemplo da chamada:</em><br>
<code>https://[seller].com.br/pvt/orders/[orderId]/cancel?sc=1&amp;an=mechantname&apos;</code></p>
<p><a href="#a81">Exemplo Completo: Solicitar Cancelamento de Pedido</a></p>
</li>
<li><p>Implementar rotina de informar dados de nota fiscal e rastreamento de entrega de um pedido. Nos dados do pedido &#xE9; enviado uma endpoint de servi&#xE7;os do Marketplace, o Seller dever&#xE1; invocar esse endpoint tanto pra informar dados de nota fiscal quanto dados de rastreamento de transportadora. O Seller ainda pode solicitar um cancelamento de um pedido que ainda n&#xE3;o enviou nota fiscal.</p>
<p><em>exemplo da chamada:</em><br>
<code>https://marketplaceServicesEndpoint/pub/orders/[marketplaceorderId]/invoice</code><br>
<code>https://marketplaceServicesEndpoint/pub/orders/[marketplaceorderId]/cancel</code><br></p>
<p><a href="#a10">Exemplo Completo: Informar nota fiscal de um pedido</a><br>
<a href="#a11">Exemplo Completo: Informar tracking de um pedido</a><br>
<a href="#a12">Exemplo Completo: Solicitar cancelamento de um pedido sem nota fiscal</a><br></p>
</li>
</ol>
<blockquote>
<p>DETALHE IMPORTANT&#xCD;SSIMO: <br>
&#xC9; preciso que todos os paths do Seller estejam debaixo da mesmo host. Exemplo:</p>
<blockquote>
<p><code>https://HOSTDOSELLER/pvt/orderForms/simulation</code><br>
<code>https://HOSTDOSELLER/pvt/installments/options</code><br>
<code>https://HOSTDOSELLER/pvt/orders</code><br>
<code>https://HOSTDOSELLER/pvt/payments/</code><br>
<code>https://HOSTDOSELLER/pvt/orders/[orderid]/fulfill</code><br>
<code>https://HOSTDOSELLER/pvt/orders/[orderid]/cancel</code><br></p>
</blockquote>
<p>ATEN&#xC7;&#xC3;O:</p>
<blockquote>
<p>Caso o Seller n&#xE3;o possua ambiente certificado PCI para receber os dados de pagamento, um novo modelo dever&#xE1; ser usado, que &#xE9; a cria&#xE7;&#xE3;o de uma conta no gateway VTEX para o Seller receber as transa&#xE7;&#xF5;es de pagamento. Nesse modelo n&#xE3;o h&#xE1; a necessidade do Seller implementar os passos 4 e 6 do fluxo.</p>
</blockquote>
</blockquote>
<hr>
<h2 id="abaixo-segue-o-passo-a-passo-detalhado-de-cada-fluxo"><a name="abaixo-segue-o-passo-a-passo-detalhado-de-cada-fluxo" class="plugin-anchor" href="#abaixo-segue-o-passo-a-passo-detalhado-de-cada-fluxo"><span class="fa fa-link"></span></a>Abaixo segue o passo a passo detalhado de cada fluxo:</h2>
<h3 id="troca-de-catalogo-e-atualiza%C3%A7%C3%A3o-de-pre%C3%A7o-e-estoque-de-sku"><a name="troca-de-catalogo-e-atualiza%C3%A7%C3%A3o-de-pre%C3%A7o-e-estoque-de-sku" class="plugin-anchor" href="#troca-de-catalogo-e-atualiza%C3%A7%C3%A3o-de-pre%C3%A7o-e-estoque-de-sku"><span class="fa fa-link"></span></a>Troca de Catalogo e Atualiza&#xE7;&#xE3;o de Pre&#xE7;o e Estoque de SKU</h3>
<p>Sugest&#xE3;o de SKU, atualiza&#xE7;&#xE3;o de pre&#xE7;o e estoque. Toda vez que houver uma altera&#xE7;&#xE3;o no pre&#xE7;o ou no estoque de um SKU no Seller, o Seller deve enviar uma notifica&#xE7;&#xE3;o de mudan&#xE7;a de SKU para a loja hospedada na VTEX, caso a loja retorne em seu servi&#xE7;o o <strong>response status 404</strong>, significa que a <strong>SKU n&#xE3;o existe na loja</strong>, ent&#xE3;o o Seller deve enviar a sugest&#xE3;o de SKU para a loja.<br>
Caso a loja retorne em seu servi&#xE7;o o <strong>response status 200 ou 202</strong>, significa que a <strong>SKU existe</strong> no Marketplace, ent&#xE3;o a Marketplace vai no Seller consultar o novo pre&#xE7;o e ou estoque.</p>
<blockquote>
<p>ATEN&#xC7;&#xC3;O:</p>
<blockquote>
<p>Este modelo <strong>n&#xE3;o</strong> contempla atualiza&#xE7;&#xF5;es de imagens e descri&#xE7;&#xE3;o de um SKU depois de catalogado (aceito) no Marketplace, ou seja, depois do SKU mapeado e aceito pelo Marketplace, somente pre&#xE7;o e estoque ser&#xE3;o atualizados dinamicamente.</p>
</blockquote>
</blockquote>
<p><em>exemplo do fluxo:</em></p>
<p><img src="sku-sugestion-seller-nao-vtex.png" alt="alt text" title="Fluxo de troca de catalogo"></p>
<p><a name="a1"><a></a></a></p>
<h3 id="enviar-notifica%C3%A7%C3%A3o-de-mudan%C3%A7a-de-pre%C3%A7o-e-estoque-de-sku"><a name="enviar-notifica%C3%A7%C3%A3o-de-mudan%C3%A7a-de-pre%C3%A7o-e-estoque-de-sku" class="plugin-anchor" href="#enviar-notifica%C3%A7%C3%A3o-de-mudan%C3%A7a-de-pre%C3%A7o-e-estoque-de-sku"><span class="fa fa-link"></span></a>Enviar Notifica&#xE7;&#xE3;o de Mudan&#xE7;a de Pre&#xE7;o e Estoque de SKU</h3>
<p>Toda vez que houver uma altera&#xE7;&#xE3;o no pre&#xE7;o ou estoque de um SKU no Seller, o Seller deve enviar uma notifica&#xE7;&#xE3;o de mudan&#xE7;a de SKU para a loja hospedada na VTEX.</p>
<p><a title="notificar mudan&#xE7;a de sku no marketplace" href="http://bridge.vtexlab.com.br/vtex.bridge.web_deploy/swagger/ui/index.html#!/CATALOG/CATALOG_Notification" target="_blank">[Developer] - Exemplo de Request de Notifica&#xE7;&#xE3;o de Mudan&#xE7;a - Endpoint da loja hospedada na VTEX</a></p>
<p><a name="a2"><a></a></a></p>
<h3 id="enviar-sugest%C3%A3o-de-sku-para-venda"><a name="enviar-sugest%C3%A3o-de-sku-para-venda" class="plugin-anchor" href="#enviar-sugest%C3%A3o-de-sku-para-venda"><span class="fa fa-link"></span></a>Enviar Sugest&#xE3;o de SKU para Venda</h3>
<p>Quando o servi&#xE7;o de notifica&#xE7;&#xE3;o descrito acima retornar um <strong>response status 404</strong>, significa que o SKU <strong>N&#xC3;O existe</strong> no Marketplace hospedado na VTEX, ent&#xE3;o o Seller envia um POST com os dados da SKU que deseja sugerir para vender no Marketplace.</p>
<blockquote>
<p>O Seller faz as sugest&#xF5;es de suas SKUs e o administrador do Marketplace realiza o mapeamento de marcas e categorias atrav&#xE9;s da pagina de administra&#xE7;&#xE3;o do Marketplace, e aceita ou n&#xE3;o a sugest&#xE3;o de SKU enviada pelo Seller.</p>
</blockquote>
<p><a title="envia sugest&#xE3;o de sku" href="http://bridge.vtexlab.com.br/vtex.bridge.web_deploy/swagger/ui/index.html#!/CATALOG/CATALOG_Sugestion" target="_blank">[Developer] - Exemplo de Request de Inser&#xE7;&#xE3;o de Sugest&#xE3;o de SKU - Endpoint da loja hospedada na VTEX</a></p>
<p><em>exemplo do POST de dados:</em></p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;BrandId&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;BrandName&quot;</span>: <span class="hljs-string">&quot;RAY BAN&quot;</span>,
  <span class="hljs-string">&quot;CategoryFullPath&quot;</span>: <span class="hljs-string">&quot;Oculos/Oculos de Sol/Masculino&quot;</span>,
  <span class="hljs-string">&quot;CategoryId&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;EAN&quot;</span>: [
    <span class="hljs-string">&quot;0123456789123&quot;</span>
  ],
  <span class="hljs-string">&quot;Height&quot;</span>: <span class="hljs-number">0.5</span>,
  <span class="hljs-string">&quot;Id&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;Images&quot;</span>: [
    {
      <span class="hljs-string">&quot;ImageUrl&quot;</span>: <span class="hljs-string">&quot;http://www.cristalliotica.com.br/image/magictoolbox_cache/8c95d73fec130487c102a73bf1ab42ce/1/1/113/thumb450x450/2790576687/zoom-RAY%20BAN%204187%20Chris%206077_4V.jpg&quot;</span>,
      <span class="hljs-string">&quot;ImageName&quot;</span>: <span class="hljs-string">&quot;Principal&quot;</span>,
      <span class="hljs-string">&quot;FileId&quot;</span>: <span class="hljs-literal">null</span>
    },
    {
      <span class="hljs-string">&quot;ImageUrl&quot;</span>: <span class="hljs-string">&quot;http://www.cristalliotica.com.br/image/magictoolbox_cache/8c95d73fec130487c102a73bf1ab42ce/1/1/113/thumb450x450/2436023899/zoom-RAY%20BAN%204187%20Chris%206077_4V%201.jpg&quot;</span>,
      <span class="hljs-string">&quot;ImageName&quot;</span>: <span class="hljs-string">&quot;Lateral&quot;</span>,
      <span class="hljs-string">&quot;FileId&quot;</span>: <span class="hljs-literal">null</span>
    }
  ],
  <span class="hljs-string">&quot;IsAssociation&quot;</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-string">&quot;IsKit&quot;</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-string">&quot;IsProductSuggestion&quot;</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-string">&quot;Length&quot;</span>: <span class="hljs-number">10</span>,
  <span class="hljs-string">&quot;ListPrice&quot;</span>: <span class="hljs-number">39900</span>,
  <span class="hljs-string">&quot;ModalId&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;Price&quot;</span>: <span class="hljs-number">39900</span>,
  <span class="hljs-string">&quot;ProductDescription&quot;</span>: <span class="hljs-string">&quot;Oculos de sol feito de material de primira qualidade, com lentes anti reflexo e astes confort&#xE1;veis&quot;</span>,
  <span class="hljs-string">&quot;ProductId&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;ProductName&quot;</span>: <span class="hljs-string">&quot;Oculos de Sol RAY BAN&quot;</span>,
  <span class="hljs-string">&quot;ProductSpecifications&quot;</span>: [
    {
      <span class="hljs-string">&quot;FieldId&quot;</span>: <span class="hljs-number">0</span>,
      <span class="hljs-string">&quot;FieldName&quot;</span>: <span class="hljs-string">&quot;Origem&quot;</span>,
      <span class="hljs-string">&quot;FieldValueIds&quot;</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">&quot;FieldValues&quot;</span>: [
        <span class="hljs-string">&quot;Importado&quot;</span>
      ]
    },
    {
      <span class="hljs-string">&quot;FieldId&quot;</span>: <span class="hljs-number">0</span>,
      <span class="hljs-string">&quot;FieldName&quot;</span>: <span class="hljs-string">&quot;Capa Inclusa&quot;</span>,
      <span class="hljs-string">&quot;FieldValueIds&quot;</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">&quot;FieldValues&quot;</span>: [
        <span class="hljs-string">&quot;Sim&quot;</span>
      ]
    }
  ],
  <span class="hljs-string">&quot;ProductSupplementaryFields&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;RefId&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// obrigat&#xF3;rio quando o EAN n&#xE3;o for enviado</span>
  <span class="hljs-string">&quot;SellerId&quot;</span>: <span class="hljs-string">&quot;Cristalli&quot;</span>,
  <span class="hljs-string">&quot;SellerModifiedDate&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;SellerStockKeepingUnitId&quot;</span>: <span class="hljs-string">&quot;cristalli00011&quot;</span>, <span class="hljs-comment">// identificador da SKU no Seller, trocar esse id para os testes</span>
  <span class="hljs-string">&quot;SkuId&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;SkuName&quot;</span>: <span class="hljs-string">&quot;Oculos de Sol RAY BAN Lente Polarizada&quot;</span>,
  <span class="hljs-string">&quot;SkuSpecifications&quot;</span>: [
    {
      <span class="hljs-string">&quot;FieldId&quot;</span>: <span class="hljs-number">0</span>,
      <span class="hljs-string">&quot;FieldName&quot;</span>: <span class="hljs-string">&quot;Lente Polarizada&quot;</span>,
      <span class="hljs-string">&quot;FieldValueIds&quot;</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">&quot;FieldValues&quot;</span>: [
        <span class="hljs-string">&quot;Sim&quot;</span>
      ]
    }
  ],
  <span class="hljs-string">&quot;SkuSupplementaryFields&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;SynonymousPropertyNames&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;WeightKg&quot;</span>: <span class="hljs-number">0.2</span>,
  <span class="hljs-string">&quot;Width&quot;</span>: <span class="hljs-number">0.5</span>
}
</code></pre>
<p><a name="a3"><a></a></a></p>
<h3 id="atualiza%C3%A7%C3%A3o-de-pre%C3%A7o-e-ou-estoque-de-sku"><a name="atualiza%C3%A7%C3%A3o-de-pre%C3%A7o-e-ou-estoque-de-sku" class="plugin-anchor" href="#atualiza%C3%A7%C3%A3o-de-pre%C3%A7o-e-ou-estoque-de-sku"><span class="fa fa-link"></span></a>Atualiza&#xE7;&#xE3;o de Pre&#xE7;o e ou Estoque de SKU</h3>
<p>Toda vez que houver uma altera&#xE7;&#xE3;o no pre&#xE7;o ou estoque, o Seller deve enviar uma notifica&#xE7;&#xE3;o de mudan&#xE7;a de SKU para a loja hospedadana VTEX, caso a loja retorne em seu servi&#xE7;o o <strong>response status 200 ou 202</strong>, significa que a SKU <strong>existe</strong> na loja, ent&#xE3;o a loja vai no Seller consultar o novo pre&#xE7;o ou estoque.</p>
<p><a title="busca de condi&#xE7;&#xF5;es comerciais no Seller" href="http://bridge.vtexlab.com.br/vtex.bridge.web_deploy/swagger/ui/index.html#!/FULFILLMENT/FULFILLMENT_Simulation" target="_blank">[Developer] - Exemplo de Request de Busca de Condi&#xE7;&#xF5;es Comerciais - Endpoint do Seller</a></p>
<p><em>Exemplo por POST:</em></p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;items&quot;</span>: [
    {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;2000037&quot;</span>,
      <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">1</span>,
      <span class="hljs-string">&quot;Seller&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>
    },
    {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;34562&quot;</span>,
      <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">2</span>,
      <span class="hljs-string">&quot;Seller&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>
    }
  ],
  <span class="hljs-string">&quot;marketingData&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;postalCode&quot;</span>: <span class="hljs-string">&quot;22051030&quot;</span>, <span class="hljs-comment">//n&#xE3;o obrigat&#xF3;rio</span>
  <span class="hljs-string">&quot;country&quot;</span>: <span class="hljs-string">&quot;BRA&quot;</span>, <span class="hljs-comment">//n&#xE3;o obrigat&#xF3;rio</span>
  <span class="hljs-string">&quot;selectedSla&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;clientProfileData&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;geoCoordinates&quot;</span>: []
}
</code></pre>
<p><em>Exemplo por GET:</em></p>
<p>QueryString com UrlEncode: <br>
<code>purchaseContext=%7b%22items%22%3a%5b%7b%22id%22%3a%2213%22%2c%22quantity%22%3a1%2c%22seller%22%3a%221%22%7d%5d%2c%22country%22%3a%22BRA%22%7d&amp;sc=1&amp;an=shopfacilfastshop</code> <br>
QueryString decodificada: <br>
<code>purchaseContext={&quot;items&quot;:[{&quot;id&quot;:&quot;2002129&quot;,&quot;quantity&quot;:1,&quot;seller&quot;:&quot;1&quot;}],&quot;marketingData&quot;:null,&quot;postalCode&quot;:&quot;22011050&quot;,&quot;country&quot;:&quot;BRA&quot;,&quot;selectedSla&quot;:null,&quot;clientProfileData&quot;:null,&quot;geoCoordinates&quot;:[]}&amp;sc=1&amp;an=shopfacilfastshop</code> <br></p>
<blockquote>
<p>ATEN&#xC7;&#xC2;O</p>
<blockquote>
<p>O CEP e o pa&#xED;s n&#xE3;o s&#xE3;o obrigat&#xF3;rios, mais quando tiver 1 deles o outro se torna obrigat&#xF3;rio.</p>
</blockquote>
</blockquote>
<hr>
<h3 id="simula%C3%A7%C3%A3o-de-carrinho-e-consulta-parcelamento"><a name="simula%C3%A7%C3%A3o-de-carrinho-e-consulta-parcelamento" class="plugin-anchor" href="#simula%C3%A7%C3%A3o-de-carrinho-e-consulta-parcelamento"><span class="fa fa-link"></span></a>Simula&#xE7;&#xE3;o de Carrinho e Consulta Parcelamento</h3>
<p>Este t&#xF3;pico tem por objetivo auxiliar o integrador na simula&#xE7;&#xE3;o de carrinho, consultar parcelamento entre o marketplace VTEX com uma loja <strong>n&#xE3;o</strong> VTEX. Simular um pedido e consultar as formas de parcelamento.</p>
<blockquote>
<p>ATEN&#xC7;&#xC3;O</p>
<blockquote>
<p>Esses m&#xE9;todos s&#xE3;o usados no momento do fechamento da compra no Marketplace, por isso, &#xE9; de suma import&#xE2;ncia para uma boa convers&#xE3;o, que esses m&#xE9;todos sejam perform&#xE1;ticos e de alta disponibilidade.</p>
</blockquote>
</blockquote>
<h3 id="no-carrinho-e-no-pagamento"><a name="no-carrinho-e-no-pagamento" class="plugin-anchor" href="#no-carrinho-e-no-pagamento"><span class="fa fa-link"></span></a>No Carrinho e no Pagamento</h3>
<p>Quando um produto &#xE9; inserido no carrinho no marketplace VTEX, ou faz se alguma edi&#xE7;&#xE3;o no carrinho, uma consulta de simula&#xE7;&#xE3;o de carrinho &#xE9; feita no Seller para checar a validade das condi&#xE7;&#xF5;es comerciais (pre&#xE7;o, estoque, frete e SLAs de entrega).</p>
<p><em>Exemplo do fluxo de chamadas no carrinho:</em></p>
<p><img src="fechamento-fluxo.png" alt="alt text" title="Title"></p>
<p><a name="a4"><a></a></a></p>
<h3 id="simula%C3%A7%C3%A3o-de-carrinho-post-e-get"><a name="simula%C3%A7%C3%A3o-de-carrinho-post-e-get" class="plugin-anchor" href="#simula%C3%A7%C3%A3o-de-carrinho-post-e-get"><span class="fa fa-link"></span></a>Simula&#xE7;&#xE3;o de Carrinho (POST E GET)</h3>
<p>Quando ocorre uma edi&#xE7;&#xE3;o no carrinho, uma chamada <strong>POST</strong> ser&#xE1; feita no Seller para checar a disponibilidade dos itens - Endpoint do Seller.</p>
<p>endpoint: <code>https://[sellerendpoint]/pvt/orderForms/simulation?sc=[idcanal]&amp;an=[mechantname]</code><br>
verb: <strong>POST</strong><br>
Content-Type: <strong>application/json</strong><br>
Accept: <strong>application/json</strong><br></p>
<blockquote>
<p>ATEN&#xC7;&#xC2;O</p>
<blockquote>
<p>Este m&#xE9;todo tamb&#xE9;m requer uma implementa&#xE7;&#xE3;o em GET, que ser&#xE1; usada para constru&#xE7;&#xE3;o
de cache do lado da plataforma VTEX, evitando tantos acessos ao POST. <br></p>
</blockquote>
<p>PARAMETROS</p>
<blockquote>
<p>?<strong>sc</strong>=[idcanal]<strong>an</strong>=[mechantname]. Esses par&#xE2;metros servem para o Seller fazer o controle de qual Marketplace est&#xE1; fazendo a chamada em seus servi&#xE7;os, pois, esse modelo, uma vez bem implementado servir&#xE1; para vender em qualquer Marketplace hospedado na VTEX, dando ao Seller a oportunidade de vender em N Marketplace ao mesmo tempo.</p>
<blockquote>
<p><strong>sc</strong>=1&amp;<strong>an</strong>=marketplaceseller, onde <strong>sc</strong> seria a campanha (ser&#xE1; enviado 1 como padrao) e <strong>an</strong> seria o identificador do marketplace (esse dever&#xE1; ser retornado em algumas chamadas). Opcional o uso pelo Seller.</p>
</blockquote>
</blockquote>
</blockquote>
<p><em>request por POST:</em></p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;items&quot;</span>: [
    {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;2000037&quot;</span>, <span class="hljs-comment">//identificador do item no Seller</span>
      <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">//quantidade desejada</span>
      <span class="hljs-string">&quot;seller&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>
    },
    {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;34562&quot;</span>,
      <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">2</span>,
      <span class="hljs-string">&quot;seller&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>
    }
  ],
  <span class="hljs-string">&quot;marketingData&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;postalCode&quot;</span>: <span class="hljs-string">&quot;22051030&quot;</span>, <span class="hljs-comment">// n&#xE3;o obrigat&#xF3;rio</span>
  <span class="hljs-string">&quot;country&quot;</span>: <span class="hljs-string">&quot;BRA&quot;</span>, <span class="hljs-comment">// n&#xE3;o obrigat&#xF3;rio</span>
  <span class="hljs-string">&quot;selectedSla&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;clientProfileData&quot;</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-string">&quot;geoCoordinates&quot;</span>: []
}
</code></pre>
<p>Na pratilheira e na p&#xE1;gina de detalhe de produto uma chamada <strong>GET</strong> ser&#xE1; feita no Seller para checar a disponibilidade dos itens - Endpoint do Seller.</p>
<p>endpoint: <code>https://[sellerendpoint]/pvt/orderForms/simulation?purchaseContext=%7b%22items%22%3a%5b%7b%22id%22%3a%2213%22%2c%22quantity%22%3a1%2c%22seller%22%3a%221%22%7d%5d%2c%22country%22%3a%22BRA%22%7d&amp;sc=idCanal&amp;an=merchantName</code><br>
verb: <strong>GET</strong><br>
Accept: <strong>application/json</strong><br>
Parametro: <strong>purchaseContext</strong> - Esse par&#xE2;metro na QueryString &#xE9; o mesmo JSON do POST serializado e com URLEncode<br></p>
<p><em>request Por GET:</em></p>
<p>QueryString com UrlEncode: <br>
<code>purchaseContext=%7b%22items%22%3a%5b%7b%22id%22%3a%2213%22%2c%22quantity%22%3a1%2c%22seller%22%3a%221%22%7d%5d%2c%22country%22%3a%22BRA%22%7d&amp;sc=1&amp;an=shopfacilfastshop</code> <br>
QueryString decodificada: <br>
<code>purchaseContext={&quot;items&quot;:[{&quot;id&quot;:&quot;2002129&quot;,&quot;quantity&quot;:1,&quot;seller&quot;:&quot;1&quot;}],&quot;marketingData&quot;:null,&quot;postalCode&quot;:&quot;22011050&quot;,&quot;country&quot;:&quot;BRA&quot;,&quot;selectedSla&quot;:null,&quot;clientProfileData&quot;:null,&quot;geoCoordinates&quot;:[]}&amp;sc=1&amp;an=shopfacilfastshop</code> <br></p>
<p><em>Via POST:</em><br>
<code>https://[sellerendpoint]/pvt/orderForms/simulation</code><br></p>
<pre><code class="lang-json">{<span class="hljs-string">&quot;items&quot;</span>:[{<span class="hljs-string">&quot;id&quot;</span>:<span class="hljs-string">&quot;13&quot;</span>,<span class="hljs-string">&quot;quantity&quot;</span>:<span class="hljs-number">1</span>,<span class="hljs-string">&quot;seller&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>}],<span class="hljs-string">&quot;country&quot;</span>:<span class="hljs-string">&quot;BRA&quot;</span>}
</code></pre>
<p><em>Via GET:</em><br>
<code>https://[sellerendpoint]/pvt/orderForms/simulation?purchaseContext=%7b%22items%22%3a%5b%7b%22id%22%3a%2213%22%2c%22quantity%22%3a1%2c%22seller%22%3a%221%22%7d%5d%2c%22country%22%3a%22BRA%22%7d</code></p>
<p><em>response (GET e POST):</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;items&quot;</span>: [ <span class="hljs-comment">//pode vir um array vazio caso item insidponivel</span>
        {
            <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;287611&quot;</span>,<span class="hljs-comment">// obrigat&#xF3;rio, string - identificador so SKU</span>
            <span class="hljs-string">&quot;requestIndex&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// obrigat&#xF3;rio, int - representa a posi&#xE7;&#xE3;o desse item no array original (request)</span>
            <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">7390</span>, <span class="hljs-comment">// obrigat&#xF3;rio, int - pre&#xE7;o por, os dois d&#xED;gitos menos significativos s&#xE3;o os centavos</span>
            <span class="hljs-string">&quot;listPrice&quot;</span>: <span class="hljs-number">7490</span>, <span class="hljs-comment">// obrigat&#xF3;rio, int - pre&#xE7;o de, os dois d&#xED;gitos menos significativos s&#xE3;o os centavos</span>
            <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// obrigat&#xF3;rio, int - retornar a quantidade solicitada ou a quantidade que consegue atender</span>
            <span class="hljs-string">&quot;seller&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-comment">// obrigat&#xF3;rio, string - retonar o que foi passado no request</span>
            <span class="hljs-string">&quot;merchantName&quot;</span>: <span class="hljs-string">&quot;shopfacilfastshop&quot;</span>, <span class="hljs-comment">// se o pagamento for no seller, retornar o que recebeu no parametro an.</span>
            <span class="hljs-string">&quot;priceValidUntil&quot;</span>: <span class="hljs-string">&quot;2014-03-01T22:58:28.143&quot;</span>  <span class="hljs-comment">// pode ser nulo, string - data de validade do pre&#xE7;o.</span>
            <span class="hljs-string">&quot;offerings&quot;</span>:[  <span class="hljs-comment">//array opcional de ofertas, por&#xE9;m n&#xE3;o pode ser nulo: enviar array vazio.</span>
                {
                    <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;Garantia&quot;</span>, <span class="hljs-comment">//obrigat&#xF3;rio, string - tipo do servi&#xE7;o</span>
                    <span class="hljs-string">&quot;id&quot;</span>:<span class="hljs-string">&quot;5&quot;</span>,  <span class="hljs-comment">//obrigat&#xF3;rio, string - identificador do servi&#xE7;o</span>
                    <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;Garantia de 1 ano&quot;</span>, <span class="hljs-comment">//obrigat&#xF3;rio, string - nome do servi&#xE7;o</span>
                    <span class="hljs-string">&quot;price&quot;</span>:<span class="hljs-number">10000</span>  <span class="hljs-comment">//obrigat&#xF3;rio, int - pre&#xE7;o do servi&#xE7;o, os dois d&#xED;gitos menos significativos s&#xE3;o os centavos</span>
                },
                {
                    <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;Embalagem de Presente&quot;</span>,
                    <span class="hljs-string">&quot;id&quot;</span>:<span class="hljs-string">&quot;6&quot;</span>,
                    <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;Embalagem de Presente&quot;</span>,
                    <span class="hljs-string">&quot;price&quot;</span>:<span class="hljs-number">250</span>
                }
            ]
        },
        {
            <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;5837&quot;</span>,
            <span class="hljs-string">&quot;requestIndex&quot;</span>: <span class="hljs-number">1</span>,
            <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">890</span>,
            <span class="hljs-string">&quot;listPrice&quot;</span>: <span class="hljs-number">990</span>,
            <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">5</span>,
            <span class="hljs-string">&quot;seller&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
            <span class="hljs-string">&quot;merchantName&quot;</span>: <span class="hljs-string">&quot;shopfacilfastshop&quot;</span>, <span class="hljs-comment">// se o pagamento for no seller, retornar o que recebeu no parametro an.</span>
            <span class="hljs-string">&quot;priceValidUntil&quot;</span>: <span class="hljs-literal">null</span>
        }
    ],
    <span class="hljs-string">&quot;logisticsInfo&quot;</span>: [ <span class="hljs-comment">// array de informa&#xE7;&#xF5;es, quando produtos indispon&#xED;veis retornar vazio []</span>
        {
            <span class="hljs-string">&quot;itemIndex&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// obrigat&#xF3;rio, int - index do array de items</span>
            <span class="hljs-string">&quot;stockBalance&quot;</span>: <span class="hljs-number">99</span>, <span class="hljs-comment">// obrigat&#xF3;rio, int - estoque que atende</span>
            <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// obrigat&#xF3;rio, int - retornar a quantidade solicitada ou a quantidade que consegue atender</span>
            <span class="hljs-string">&quot;shipsTo&quot;</span>: [ <span class="hljs-string">&quot;BRA&quot;</span>],  <span class="hljs-comment">// obrigat&#xF3;rio, array de string com as siglas dos pa&#xED;ses de entrega</span>
            <span class="hljs-string">&quot;slas&quot;</span>: [  <span class="hljs-comment">// obrigat&#xF3;rio,  pode ser um array vazio na ausencia de CEP.</span>
                {
                    <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;Expressa&quot;</span>,  <span class="hljs-comment">//obrigat&#xF3;rio, string - identificador tipo entrega</span>
                    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Entrega Expressa&quot;</span>,<span class="hljs-comment">// obrigat&#xF3;rio, string - nome do tipo entrega</span>
                    <span class="hljs-string">&quot;shippingEstimate&quot;</span>: <span class="hljs-string">&quot;2bd&quot;</span>, <span class="hljs-comment">// obrigat&#xF3;rio, string - doas estimados para a entrega, bd == &quot;business days&quot;</span>
                    <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">1000</span> <span class="hljs-comment">// obrigat&#xF3;rio, int - custo da entrega, os dois d&#xED;gitos menos significativos s&#xE3;o os centavos</span>
                    <span class="hljs-string">&quot;availableDeliveryWindows&quot;</span>: [  <span class="hljs-comment">// opcional, janelas de entrega,  podendo ser um array vazio</span>
                    ]
                },
                {
                    <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;Agendada&quot;</span>,
                    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Entrega Agendada&quot;</span>,
                    <span class="hljs-string">&quot;shippingEstimate&quot;</span>: <span class="hljs-string">&quot;5d&quot;</span>,  <span class="hljs-comment">// d - days, bd -business days</span>
                    <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">800</span>,
                    <span class="hljs-string">&quot;availableDeliveryWindows&quot;</span>: [
                         {
                            <span class="hljs-string">&quot;startDateUtc&quot;</span>: <span class="hljs-string">&quot;2013-02-04T08:00:00+00:00&quot;</span>,  <span class="hljs-comment">// date, obrigat&#xF3;rio se for enviado delivery window</span>
                            <span class="hljs-string">&quot;endDateUtc&quot;</span>: <span class="hljs-string">&quot;2013-02-04T13:00:00+00:00&quot;</span>, <span class="hljs-comment">// date, obrigat&#xF3;rio se for enviado delivery window</span>
                            <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// int, obrigat&#xF3;rio se for enviado delivery window - o valor adicional da entrega agendada</span>
                        },
                    ]
                }
            ]
        },
        {
            <span class="hljs-string">&quot;itemIndex&quot;</span>: <span class="hljs-number">1</span>,
            <span class="hljs-string">&quot;stockBalance&quot;</span>: <span class="hljs-number">1237</span>,
            <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">5</span>,
            <span class="hljs-string">&quot;shipsTo&quot;</span>: [ <span class="hljs-string">&quot;BRA&quot;</span> ],
            <span class="hljs-string">&quot;slas&quot;</span>: [
                {
                    <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;Normal&quot;</span>,
                    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Entrega Normal&quot;</span>,
                    <span class="hljs-string">&quot;shippingEstimate&quot;</span>: <span class="hljs-string">&quot;5bd&quot;</span>, <span class="hljs-comment">// bd - business days</span>
                    <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">200</span>
                }
            ]
        }
    ],
    <span class="hljs-string">&quot;country&quot;</span>:<span class="hljs-string">&quot;BRA&quot;</span>,   <span class="hljs-comment">// string, nulo se n&#xE3;o enviado</span>
    <span class="hljs-string">&quot;postalCode&quot;</span>:<span class="hljs-string">&quot;22251-030&quot;</span>   <span class="hljs-comment">// string, nulo se n&#xE3;o enviado</span>
}
</code></pre>
<blockquote>
<p>ATEN&#xC7;&#xC3;O!</p>
<blockquote>
<p>O valor do frete deve ser retornado por item consultado. <br>
Quando n&#xE3;o for passado CEP, ou o item n&#xE3;o puder ser entregue no CEP passado, retornar o array de SLAs vazio (slas[]). <br>
No campo quantity, retornar o solicitado ou a quantidade que consegue atender. <br>
No campo stockBalance retornar sempre a quantidade que tiver em estoque.</p>
</blockquote>
</blockquote>
<p><a name="a5"><a></a></a></p>
<h3 id="consulta-de-op%C3%A7%C3%B5es-de-parcelamento"><a name="consulta-de-op%C3%A7%C3%B5es-de-parcelamento" class="plugin-anchor" href="#consulta-de-op%C3%A7%C3%B5es-de-parcelamento"><span class="fa fa-link"></span></a>Consulta de Op&#xE7;&#xF5;es de Parcelamento.</h3>
<blockquote>
<p>S&#xF3; implementar esse m&#xE9;todo Sellers que possuirem o certificado PCI</p>
</blockquote>
<p>Quando cliente for para a p&#xE1;gina de pagamento, uma chamada ser&#xE1; feita no Seller para buscar as formas de parcelamento das formas de pagamento. O Seller <strong>n&#xE3;o</strong> VTEX dever&#xE1; conhecer previamente os ids das formas de pagamento do marketplace VTEX - Endpoint do Seller.</p>
<blockquote>
<p>Identificadores das formas de pagamento mais comuns no gateway das lojas VTEX:</p>
<blockquote>
<p>1-American Express <br>
2-Visa <br>
3-Diners <br>
8-Hipercard <br>
4-Mastercard <br></p>
</blockquote>
</blockquote>
<p>endpoint: <code>https://[sellerendpoint]/pvt/installments/options?sc=[idcanal]&amp;an=[mechantname]</code><br>
verb: <strong>POST</strong><br>
Content-Type: <strong>application/json</strong><br>
Accept: <strong>application/json</strong><br></p>
<p><em>request:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;PaymentSystemsIds&quot;</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>], <span class="hljs-comment">//ids das formas de pagamento na loja VTEX</span>
    <span class="hljs-string">&quot;SubtotalAsInt&quot;</span>:<span class="hljs-number">27280</span>, <span class="hljs-comment">//total que se deseja parcelar</span>
    <span class="hljs-string">&quot;Items&quot;</span>:[ <span class="hljs-comment">//opcional</span>
        {
        <span class="hljs-string">&quot;PriceAsInt&quot;</span>:<span class="hljs-number">24800</span>, <span class="hljs-comment">//pre&#xE7;o do SKU</span>
        <span class="hljs-string">&quot;Quantity&quot;</span>:<span class="hljs-number">1</span>, <span class="hljs-comment">//quantidade do SKU</span>
        <span class="hljs-string">&quot;Id&quot;</span>:<span class="hljs-string">&quot;1940388&quot;</span>, <span class="hljs-comment">//string, identificador do SKU no Seller.</span>
        <span class="hljs-string">&quot;SellerId&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>,
        <span class="hljs-string">&quot;SalesChannel&quot;</span>:<span class="hljs-number">1</span> <span class="hljs-comment">//identificador do canal de vendas no Seller, caso exista</span>
        }
    ],
    <span class="hljs-string">&quot;PostalCode&quot;</span>:<span class="hljs-string">&quot;22051030&quot;</span> <span class="hljs-comment">//CEP, opcional</span>
}
</code></pre>
<p><em>response:</em></p>
<pre><code class="lang-json">[
    {
      <span class="hljs-string">&quot;paymentSystem&quot;</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// int -identificador da forma de pagamento</span>
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Visa&quot;</span>,
      <span class="hljs-string">&quot;groupName&quot;</span>: <span class="hljs-string">&quot;creditCard&quot;</span>,
      <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">27280</span>, <span class="hljs-comment">// int, valor solicitado para parcelar</span>
      <span class="hljs-string">&quot;installments&quot;</span>: [
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">5</span>, <span class="hljs-comment">// int, numero de parcelas</span>
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">5556</span>, <span class="hljs-comment">// int, valor da parecela</span>
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">170</span>, <span class="hljs-comment">// int, taxa de juros, ser&#xE1; divido por 100</span>
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// boolean - tem juros?</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">4</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">6820</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">3</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">9093</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">2</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">13640</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">1</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">27280</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        }
      ]
    },
    {
      <span class="hljs-string">&quot;paymentSystem&quot;</span>: <span class="hljs-number">1</span>,
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;American Express&quot;</span>,
      <span class="hljs-string">&quot;groupName&quot;</span>: <span class="hljs-string">&quot;creditCard&quot;</span>,
      <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">27280</span>,
      <span class="hljs-string">&quot;installments&quot;</span>: [
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">5</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">5456</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">4</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">6820</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">3</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">9093</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">2</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">13640</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">1</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">27280</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        }
      ]
    },
    {
      <span class="hljs-string">&quot;paymentSystem&quot;</span>: <span class="hljs-number">4</span>,
      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mastercard&quot;</span>,
      <span class="hljs-string">&quot;groupName&quot;</span>: <span class="hljs-string">&quot;creditCard&quot;</span>,
      <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">27280</span>,
      <span class="hljs-string">&quot;installments&quot;</span>: [
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">5</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">5456</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">4</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">6820</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">3</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">9093</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">2</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">13640</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        },
        {
          <span class="hljs-string">&quot;count&quot;</span>: <span class="hljs-number">1</span>,
          <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">27280</span>,
          <span class="hljs-string">&quot;interestRate&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;hasInterestRate&quot;</span>: <span class="hljs-literal">false</span>
        }
      ]
    }
]
</code></pre>
<hr>
<h3 id="enviar-pedido-e-informar-pagamento"><a name="enviar-pedido-e-informar-pagamento" class="plugin-anchor" href="#enviar-pedido-e-informar-pagamento"><span class="fa fa-link"></span></a>Enviar Pedido e Informar Pagamento</h3>
<p>Este t&#xF3;pico tem por objetivo auxiliar o Seller n&#xE3;o VTEX a receber um pedido, receber o respectivo pagamento do pedido, e comunicar a atualiza&#xE7;&#xE3;o de status de pagamento.</p>
<blockquote>
<p>ATEN&#xC7;&#xC3;O:</p>
<blockquote>
<p>Caso o Seller n&#xE3;o possua ambiente certificado para receber os dados de pagamento, um novo modelo dever&#xE1; ser usado, que &#xE9; a cria&#xE7;&#xE3;o de uma conta no gateway VTEX para o Seller receber as transa&#xE7;&#xF5;es de pagamento.</p>
</blockquote>
</blockquote>
<p><em>exemplo do fluxo de chamadas de descida de pedido, pagamento e atualiza&#xE7;&#xE3;o de status de pagamento:</em></p>
<p><img src="pedido-pagamento-fluxo.png" alt="alt text" title="Title"></p>
<p><a name="a6"><a></a></a></p>
<h3 id="enviar-pedido"><a name="enviar-pedido" class="plugin-anchor" href="#enviar-pedido"><span class="fa fa-link"></span></a>Enviar Pedido</h3>
<p>Quando o pedido &#xE9; fechado no ambiente do Marketplace hospedado na VTEX, um POST &#xE9; feito no Seller, para que este possa receber a ordem de pedido - endpoint do Seller.</p>
<p>endpoint: <code>https://sellerendpoint/pvt/orders?sc=[idcanal]&amp;an=[mechantname]</code><br>
verb: <strong>POST</strong><br>
Content-Type: <strong>application/json</strong><br>
Accept: <strong>application/json</strong><br></p>
<p><em>request:</em></p>
<pre><code class="lang-json">[
  {
    <span class="hljs-string">&quot;marketplaceOrderId&quot;</span>: <span class="hljs-string">&quot;959311095&quot;</span>, <span class="hljs-comment">// identificador do pedido no market place</span>
    <span class="hljs-string">&quot;marketplaceServicesEndpoint&quot;</span>:<span class="hljs-string">&quot;http://sandboxintegracao.vtexcommercestable.com.br/api/oms&quot;</span>, <span class="hljs-comment">// leia o t&#xF3;pico Invocando MarketplaceServicesEndpoint Actions</span>
    <span class="hljs-string">&quot;marketplacePaymentValue&quot;</span>: <span class="hljs-number">11080</span>, <span class="hljs-comment">//valor que o marketplace se compromete a pagar para o Seller</span>
    <span class="hljs-string">&quot;items&quot;</span>: [
      {
        <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;2002495&quot;</span>, <span class="hljs-comment">// identificadro da SKU no Seller</span>
        <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// quantidade comprada</span>
        <span class="hljs-string">&quot;Seller&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
        <span class="hljs-string">&quot;commission&quot;</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">&quot;freightCommission&quot;</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">9990</span>, <span class="hljs-comment">// pre&#xE7;o da SKU</span>
        <span class="hljs-string">&quot;bundleItems&quot;</span>: [], <span class="hljs-comment">// servi&#xE7;os. Ex: embalagem pra presente.</span>
        <span class="hljs-string">&quot;itemAttachment&quot;</span>: {
          <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-literal">null</span>,
          <span class="hljs-string">&quot;content&quot;</span>: {}
        },
        <span class="hljs-string">&quot;attachments&quot;</span>: [], <span class="hljs-comment">// customiza&#xE7;&#xE3;o do item, Ex:camisa com o numero 10</span>
        <span class="hljs-string">&quot;priceTags&quot;</span>: [],
        <span class="hljs-string">&quot;measurementUnit&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// unidade de medida</span>
        <span class="hljs-string">&quot;unitMultiplier&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// unidade multipladora, Ex: venda por quilo</span>
        <span class="hljs-string">&quot;isGift&quot;</span>: <span class="hljs-literal">false</span>
      }
    ],
    <span class="hljs-string">&quot;clientProfileData&quot;</span>: {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;clientProfileData&quot;</span>,
      <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;26e6a2f59cef4f8bb09882d7cf758d71@ct.vtex.com.br&quot;</span>, <span class="hljs-comment">// e-mail do cliente</span>
      <span class="hljs-string">&quot;firstName&quot;</span>: <span class="hljs-string">&quot;Jonas&quot;</span>, <span class="hljs-comment">// primeiro nome do ciente</span>
      <span class="hljs-string">&quot;lastName&quot;</span>: <span class="hljs-string">&quot;Alves de Oliveira&quot;</span>, <span class="hljs-comment">// sobrenome do cliente</span>
      <span class="hljs-string">&quot;documentType&quot;</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">&quot;document&quot;</span>: <span class="hljs-string">&quot;3244239851&quot;</span>, <span class="hljs-comment">// documento</span>
      <span class="hljs-string">&quot;phone&quot;</span>: <span class="hljs-string">&quot;+552123232323&quot;</span>, <span class="hljs-comment">// fone</span>
      <span class="hljs-string">&quot;corporateName&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// se pessoa juridica, razao social</span>
      <span class="hljs-string">&quot;tradeName&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// se pessoa juridica, nome fantasia</span>
      <span class="hljs-string">&quot;corporateDocument&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// se pessoa juridica, documento</span>
      <span class="hljs-string">&quot;stateInscription&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// se pessoa juridica, iscri&#xE7;&#xE3;o estadual</span>
      <span class="hljs-string">&quot;corporatePhone&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// se pessoa juridica, fone</span>
      <span class="hljs-string">&quot;isCorporate&quot;</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// &#xE9; pessoa juridica?</span>
      <span class="hljs-string">&quot;userProfileId&quot;</span>: <span class="hljs-literal">null</span>
    },
    <span class="hljs-string">&quot;shippingData&quot;</span>: {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;shippingData&quot;</span>,
      <span class="hljs-string">&quot;address&quot;</span>: {
        <span class="hljs-string">&quot;addressType&quot;</span>: <span class="hljs-string">&quot;Residencial&quot;</span>, <span class="hljs-comment">// tipo do endere&#xE7;o</span>
        <span class="hljs-string">&quot;receiverName&quot;</span>: <span class="hljs-string">&quot;Jonas Alves de Oliveira&quot;</span>, <span class="hljs-comment">// nome do destinat&#xE1;rio</span>
        <span class="hljs-string">&quot;addressId&quot;</span>: <span class="hljs-string">&quot;Casa&quot;</span>, <span class="hljs-comment">// identificador do endere&#xE7;o</span>
        <span class="hljs-string">&quot;postalCode&quot;</span>: <span class="hljs-string">&quot;13476103&quot;</span>, <span class="hljs-comment">// c&#xF3;digo postal</span>
        <span class="hljs-string">&quot;city&quot;</span>: <span class="hljs-string">&quot;Americana&quot;</span>, <span class="hljs-comment">// cidade</span>
        <span class="hljs-string">&quot;state&quot;</span>: <span class="hljs-string">&quot;SP&quot;</span>, <span class="hljs-comment">// unidade federativa</span>
        <span class="hljs-string">&quot;country&quot;</span>: <span class="hljs-string">&quot;BRA&quot;</span>, <span class="hljs-comment">// pa&#xED;s</span>
        <span class="hljs-string">&quot;street&quot;</span>: <span class="hljs-string">&quot;JO&#xC3;O DAM&#xC1;ZIO GOMES&quot;</span>, <span class="hljs-comment">// logradouro</span>
        <span class="hljs-string">&quot;number&quot;</span>: <span class="hljs-string">&quot;311&quot;</span>, <span class="hljs-comment">// n&#xFA;mero do endere&#xE7;o</span>
        <span class="hljs-string">&quot;neighborhood&quot;</span>: <span class="hljs-string">&quot;S&#xC3;O JOS&#xC9;&quot;</span>, <span class="hljs-comment">// bairro</span>
        <span class="hljs-string">&quot;complement&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// complemnto</span>
        <span class="hljs-string">&quot;reference&quot;</span>: <span class="hljs-string">&quot;Bairro Praia Azul / Posto de Sa&#xFA;de 17&quot;</span>, <span class="hljs-comment">// refrencia</span>
        <span class="hljs-string">&quot;geoCoordinates&quot;</span>: []
      },
      <span class="hljs-string">&quot;logisticsInfo&quot;</span>: [
        {
          <span class="hljs-string">&quot;itemIndex&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// index do array de itens</span>
          <span class="hljs-string">&quot;selectedSla&quot;</span>: <span class="hljs-string">&quot;Normal&quot;</span>, <span class="hljs-comment">// tipo de entrega</span>
          <span class="hljs-string">&quot;lockTTL&quot;</span>: <span class="hljs-string">&quot;8d&quot;</span>, <span class="hljs-comment">// dias de reserva</span>
          <span class="hljs-string">&quot;shippingEstimate&quot;</span>: <span class="hljs-string">&quot;7d&quot;</span>, <span class="hljs-comment">// dias estimados para a entrega</span>
          <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">1090</span>, <span class="hljs-comment">// pre&#xE7;o da entrega</span>
          <span class="hljs-string">&quot;deliveryWindow&quot;</span>: <span class="hljs-literal">null</span> <span class="hljs-comment">// janela de entrega</span>
        }
      ]
    },
    <span class="hljs-string">&quot;openTextField&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">//opcional, string</span>
    <span class="hljs-string">&quot;marketingData&quot;</span>: {<span class="hljs-comment">//opcional, pode ser null</span>
      <span class="hljs-string">&quot;utmSource&quot;</span>: <span class="hljs-string">&quot;buscape&quot;</span>,
      <span class="hljs-string">&quot;utmMedium&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,
      <span class="hljs-string">&quot;utmCampaign&quot;</span>: <span class="hljs-string">&quot;fretegratis&quot;</span>,
      <span class="hljs-string">&quot;utmiPage&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>,
      <span class="hljs-string">&quot;utmiPart&quot;</span>: <span class="hljs-string">&quot;BuscaFullText&quot;</span>,
      <span class="hljs-string">&quot;utmiCampaign&quot;</span>: <span class="hljs-string">&quot;capa artscase para iphone 5 e 5s slimfit rachel taylor contemporary colorida   padrao&quot;</span>
    },
    <span class="hljs-string">&quot;paymentData&quot;</span>:{
        <span class="hljs-string">&quot;merchantName&quot;</span>:<span class="hljs-string">&quot;shopfacilfastshop&quot;</span> <span class="hljs-comment">//identificador do marketplaceseller</span>
    }
  }
]
</code></pre>
<p><em>response:</em></p>
<pre><code class="lang-json">[
  {
    <span class="hljs-string">&quot;marketplaceOrderId&quot;</span>: <span class="hljs-string">&quot;959311095&quot;</span>,
    <span class="hljs-string">&quot;orderId&quot;</span>: <span class="hljs-string">&quot;123543123&quot;</span>, <span class="hljs-comment">//** - identificador do pedido inserido no Seller</span>
    <span class="hljs-string">&quot;followUpEmail&quot;</span>: <span class="hljs-string">&quot;75c70c09dbb3498c9b3bbdee59bf0687@ct.vtex.com.br&quot;</span>,
    <span class="hljs-string">&quot;items&quot;</span>: [
      {
        <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;2002495&quot;</span>,
        <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">&quot;Seller&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
        <span class="hljs-string">&quot;commission&quot;</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">&quot;freightCommission&quot;</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">9990</span>,
        <span class="hljs-string">&quot;bundleItems&quot;</span>: [],
        <span class="hljs-string">&quot;priceTags&quot;</span>: [],
        <span class="hljs-string">&quot;measurementUnit&quot;</span>: <span class="hljs-string">&quot;un&quot;</span>,
        <span class="hljs-string">&quot;unitMultiplier&quot;</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">&quot;isGift&quot;</span>: <span class="hljs-literal">false</span>
      }
    ],
    <span class="hljs-string">&quot;clientProfileData&quot;</span>: {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;clientProfileData&quot;</span>,
      <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;5c77abaea35f4cb6824b9326942c00e5@ct.vtex.com.br&quot;</span>,
      <span class="hljs-string">&quot;firstName&quot;</span>: <span class="hljs-string">&quot;JONAS&quot;</span>,
      <span class="hljs-string">&quot;lastName&quot;</span>: <span class="hljs-string">&quot;ALVES DE OLIVEIRA&quot;</span>,
      <span class="hljs-string">&quot;documentType&quot;</span>: <span class="hljs-string">&quot;cpf&quot;</span>,
      <span class="hljs-string">&quot;document&quot;</span>: <span class="hljs-string">&quot;32133239851&quot;</span>,
      <span class="hljs-string">&quot;phone&quot;</span>: <span class="hljs-string">&quot;1592712979&quot;</span>,
      <span class="hljs-string">&quot;corporateName&quot;</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">&quot;tradeName&quot;</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">&quot;corporateDocument&quot;</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">&quot;stateInscription&quot;</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">&quot;corporatePhone&quot;</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">&quot;isCorporate&quot;</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-string">&quot;userProfileId&quot;</span>: <span class="hljs-literal">null</span>
    },
    <span class="hljs-string">&quot;shippingData&quot;</span>: {
      <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;shippingData&quot;</span>,
      <span class="hljs-string">&quot;address&quot;</span>: {
        <span class="hljs-string">&quot;addressType&quot;</span>: <span class="hljs-string">&quot;Residencial&quot;</span>,
        <span class="hljs-string">&quot;receiverName&quot;</span>: <span class="hljs-string">&quot;JONAS ALVES DE OLIVEIRA&quot;</span>,
        <span class="hljs-string">&quot;addressId&quot;</span>: <span class="hljs-string">&quot;Casa&quot;</span>,
        <span class="hljs-string">&quot;postalCode&quot;</span>: <span class="hljs-string">&quot;13476103&quot;</span>,
        <span class="hljs-string">&quot;city&quot;</span>: <span class="hljs-string">&quot;Americana&quot;</span>,
        <span class="hljs-string">&quot;state&quot;</span>: <span class="hljs-string">&quot;SP&quot;</span>,
        <span class="hljs-string">&quot;country&quot;</span>: <span class="hljs-string">&quot;BRA&quot;</span>,
        <span class="hljs-string">&quot;street&quot;</span>: <span class="hljs-string">&quot;JO&#xC3;O DAM&#xC1;ZIO GOMES&quot;</span>,
        <span class="hljs-string">&quot;number&quot;</span>: <span class="hljs-string">&quot;121&quot;</span>,
        <span class="hljs-string">&quot;neighborhood&quot;</span>: <span class="hljs-string">&quot;S&#xC3;O JOS&#xC9;&quot;</span>,
        <span class="hljs-string">&quot;complement&quot;</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-string">&quot;reference&quot;</span>: <span class="hljs-string">&quot;Bairro Praia Azul / Posto de Sa&#xFA;de 17&quot;</span>,
        <span class="hljs-string">&quot;geoCoordinates&quot;</span>: []
      },
      <span class="hljs-string">&quot;logisticsInfo&quot;</span>: [
        {
          <span class="hljs-string">&quot;itemIndex&quot;</span>: <span class="hljs-number">0</span>,
          <span class="hljs-string">&quot;selectedSla&quot;</span>: <span class="hljs-string">&quot;Normal&quot;</span>,
          <span class="hljs-string">&quot;lockTTL&quot;</span>: <span class="hljs-string">&quot;8d&quot;</span>,
          <span class="hljs-string">&quot;shippingEstimate&quot;</span>: <span class="hljs-string">&quot;5d&quot;</span>,
          <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">1090</span>,
          <span class="hljs-string">&quot;deliveryWindow&quot;</span>: <span class="hljs-literal">null</span>
        }
      ]
    },
   <span class="hljs-string">&quot;paymentData&quot;</span>:{
        <span class="hljs-string">&quot;merchantName&quot;</span>:<span class="hljs-string">&quot;shopfacilfastshop&quot;</span>, <span class="hljs-comment">// devolver o parametro an recebido no request</span>
        <span class="hljs-string">&quot;merchantPaymentReferenceId&quot;</span>:<span class="hljs-string">&quot;123543123&quot;</span> <span class="hljs-comment">// inteiro, id do pagamento, n&#xFA;mero que ser&#xE1; enviado junto com o pagamento para concilia&#xE7;&#xE3;o.</span>
    }
  }
]
</code></pre>
<blockquote>
<p>NOTA:</p>
<blockquote>
<p>Retornar no campo paymentData.merchantPaymentReferenceId um inteiro (numero) identificador que ser&#xE1; usado futuramente na mapeamento do pagamento com o pedido, ou seja, o valor que retornar nesse campo ir&#xE1; identificar o pagamento desse pedido. Pode at&#xE9; ser o &quot;orderId&quot; do Seller, caso este seja inteiro.</p>
</blockquote>
</blockquote>
<h5 id="tratamento-de-erros"><a name="tratamento-de-erros" class="plugin-anchor" href="#tratamento-de-erros"><span class="fa fa-link"></span></a>Tratamento de ERROS:</h5>
<p>Toda vez que ocoorer umerrode neg&#xF3;cio, dever&#xE1; ser retornado no um JSON no formato abaixo:</p>
<p><em>JSON de retorno de erro:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;error&quot;</span>: {
    <span class="hljs-string">&quot;code&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
    <span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;O verbo &apos;GET&apos; n&#xE3;o &#xE9; compat&#xED;vel com a rota &apos;/api/fulfillment/pvt/orders&apos;&quot;</span>,
    <span class="hljs-string">&quot;exception&quot;</span>: <span class="hljs-literal">null</span>
    }
}
</code></pre>
<blockquote>
<blockquote>
<p>Tamb&#xE9;m deve se adicionar no header de retorno as seguintes chaves:<br>
<strong>x-vtex-error-code</strong> com o codigo do erro e<br>
<strong>x-vtex-error-message</strong> com a mensagem de erro<br></p>
</blockquote>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">code</th>
<th style="text-align:left">message</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ORD021</td>
<td style="text-align:left">SKU n&#xE3;o encontrado</td>
</tr>
<tr>
<td style="text-align:left">FMT002</td>
<td style="text-align:left">Estoque indispon&#xED;vel</td>
</tr>
<tr>
<td style="text-align:left">FMT009</td>
<td style="text-align:left">Pedido duplicado</td>
</tr>
<tr>
<td style="text-align:left">FMT010</td>
<td style="text-align:left">Forma de entrega enviada n&#xE3;o dispon&#xED;vel</td>
</tr>
<tr>
<td style="text-align:left">ORD008</td>
<td style="text-align:left">Erro inesperado na cria&#xE7;&#xE3;o do pedido + Mensagm</td>
</tr>
</tbody>
</table>
<p><a name="a7"><a></a></a></p>
<h3 id="enviar-pagamento"><a name="enviar-pagamento" class="plugin-anchor" href="#enviar-pagamento"><span class="fa fa-link"></span></a>Enviar Pagamento</h3>
<blockquote>
<p>S&#xF3; implementar esse m&#xE9;todo Sellers que possuirem o certificado PCI</p>
</blockquote>
<p>Quando o pagamento do pedido &#xE9; informado no Marketplace hospedado na VTEX, um POST &#xE9; feito no Seller enviando os dados referente ao pagamento do respectivo pedido - endpoint do Seller.</p>
<p>endpoint: <code>https://sellerendpoint/pvt/payments/?sc=[idcanal]&amp;an=[mechantname]</code><br>
verb: <strong>POST</strong><br>
Content-Type: <strong>application/json</strong><br>
Accept: <strong>application/json</strong><br></p>
<p><em>request:</em></p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;referenceId&quot;</span>: <span class="hljs-string">&quot;1075&quot;</span>, <span class="hljs-comment">// merchantPaymentReferenceId retornado no request do place order</span>
  <span class="hljs-string">&quot;transactionId&quot;</span>: <span class="hljs-string">&quot;9F8EDAE2DEB540ABB66D97E8C8E3975C&quot;</span>, <span class="hljs-comment">// identificador da transa&#xE7;&#xE3;o</span>
  <span class="hljs-string">&quot;paymentData&quot;</span>: {
    <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;8051344EF1D240839E408FFF79F847CE&quot;</span>, <span class="hljs-comment">// identificador do pagamento</span>
    <span class="hljs-string">&quot;paymentSystem&quot;</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// identificador da forma depagamento</span>
    <span class="hljs-string">&quot;cardNumber&quot;</span>: <span class="hljs-string">&quot;444433332221111&quot;</span>, <span class="hljs-comment">// numero do cart&#xE3;o</span>
    <span class="hljs-string">&quot;cardHolder&quot;</span>: <span class="hljs-string">&quot;Jonas Bolognim&quot;</span>,  <span class="hljs-comment">// nome do cart&#xE3;o</span>
    <span class="hljs-string">&quot;expiryMonth&quot;</span>: <span class="hljs-number">4</span>, <span class="hljs-comment">// mes de expira&#xE7;&#xE3;o</span>
    <span class="hljs-string">&quot;expiryYear&quot;</span>: <span class="hljs-number">2021</span>, <span class="hljs-comment">// ano de expira&#xE7;&#xE3;o</span>
    <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">33594</span>, <span class="hljs-comment">// valor do pagamento</span>
    <span class="hljs-string">&quot;installments&quot;</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// numero de parcelas</span>
    <span class="hljs-string">&quot;cvv2&quot;</span>: <span class="hljs-string">&quot;071&quot;</span>,  <span class="hljs-comment">// codigo verificador</span>
    <span class="hljs-string">&quot;document&quot;</span>: <span class="hljs-string">&quot;088.965.818-85&quot;</span>, <span class="hljs-comment">//opcional, documento do pagador (ser&#xE1; enviado se antifraude ligado)</span>
    <span class="hljs-string">&quot;documentType&quot;</span>: <span class="hljs-literal">null</span> <span class="hljs-comment">//opcicional</span>
  },
  <span class="hljs-string">&quot;callbackUrl&quot;</span>: <span class="hljs-string">&quot;https://shopfacilfastshop.vtexpayments.com.br/api/pvt/callback/vtxstd/transactions/9F8EDAE2DEB540ABB66D97E8C8E3975C/payments/8051344EF1D240839E408FFF79F847CE/return&quot;</span>, <span class="hljs-comment">//url para falar de volta com o gateway de pagamento.</span>
  <span class="hljs-string">&quot;shoppingCart&quot;</span>: { <span class="hljs-comment">//resumo do carrinho</span>
    <span class="hljs-string">&quot;items&quot;</span>: [
      {
        <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;OB7727437&quot;</span>,
        <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Capa Defender para Galaxy S4 em Policarbonato e TPU Cinza e Branca - Otter box - 7727437 CNZ/BCO&quot;</span>,
        <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-number">28113</span>,
        <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">&quot;priceTags&quot;</span>: [],
        <span class="hljs-string">&quot;components&quot;</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-string">&quot;shippingDiscount&quot;</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">&quot;discount&quot;</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">&quot;refId&quot;</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-string">&quot;productId&quot;</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-string">&quot;sellingPrice&quot;</span>: <span class="hljs-number">281.13</span>
      }
    ],
    <span class="hljs-string">&quot;freight&quot;</span>: <span class="hljs-number">4724</span>, <span class="hljs-comment">//valor do frete</span>
    <span class="hljs-string">&quot;orderUrl&quot;</span>: <span class="hljs-string">&quot;http://sandboxintegracao.vtexcommercebeta.com.br/admin/checkout/#/orders?q=545843519913&quot;</span>,
    <span class="hljs-string">&quot;tax&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">//opcional, impostos</span>
    <span class="hljs-string">&quot;shippingdate&quot;</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">//opcional, data de entrega</span>
    <span class="hljs-string">&quot;shippingestimated&quot;</span>: <span class="hljs-string">&quot;21bd&quot;</span> <span class="hljs-comment">//dias estimados para entrega</span>
  }
}
</code></pre>
<blockquote>
<p>MUITO IMPORTANTE!</p>
<blockquote>
<p>Lembra do &quot;paymentData.merchantPaymentReferenceId&quot;, da reposta do receber ordem de pedido citado acima?
Ele agora vem como &quot;referenceId&quot; nos dados do pagamento, e serve para associar pedido com pagamento.</p>
</blockquote>
</blockquote>
<p>Ao receber o POST com os dados de pagamento o Seller deve responder sincronamente com o status &quot;undefined&quot; enquanto n&#xE3;o tem a informa&#xE7;&#xE3;o sobre o resultado do processo do pagamento (anti-fraude, autoriza&#xE7;&#xE3;o e aprova&#xE7;&#xE3;o). Os status do pagamento devem ser informados pela url de callback (chamada assincrona de retorno).</p>
<p><em>exemplo do POST feito na CallbackUrl de pagamento :</em></p>
<pre><code class="lang-json">{
      <span class="hljs-string">&quot;paymentId&quot;</span> : <span class="hljs-string">&quot;F5C1A4E20D3B4E07B7E871F5B5BC9F91&quot;</span>, <span class="hljs-comment">// string, obrigatorio, &quot;paymentData.Id&quot;, recebido no POST de pagamento</span>
    <span class="hljs-string">&quot;status&quot;</span> : <span class="hljs-string">&quot;undefined&quot;</span>,    <span class="hljs-comment">// string, obrigatorio, [approved | denied | undefined]</span>
      <span class="hljs-string">&quot;authorizationId&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// string, identificador da autoriza&#xE7;&#xE3;o quando aprovado.</span>
      <span class="hljs-string">&quot;bankIssueInvoiceUrl&quot;</span>:<span class="hljs-string">&quot;urldoboleto&quot;</span> <span class="hljs-comment">// string, url do boleto bancario</span>
}
</code></pre>
<blockquote>
<p>NOTA:</p>
<blockquote>
<p>A resposta de POST de dados de pagamento deve ser s&#xED;ncrona (na hora).</p>
</blockquote>
</blockquote>
<p><a name="a8"><a></a></a></p>
<h3 id="enviar-autoriza%C3%A7%C3%A3o-para-despachar"><a name="enviar-autoriza%C3%A7%C3%A3o-para-despachar" class="plugin-anchor" href="#enviar-autoriza%C3%A7%C3%A3o-para-despachar"><span class="fa fa-link"></span></a>Enviar Autoriza&#xE7;&#xE3;o Para Despachar</h3>
<p>Quando o pagamento do pedido &#xE9; conclu&#xED;do <strong>com sucesso</strong> no Seller (pagamento v&#xE1;lido), um POST dever&#xE1; ser feito na &quot;callbackUrl&quot; do pagamento, informando sucesso do pagamento (&quot;status&quot;:&quot;approved&quot;), nesse momento o Marketplace hospedado na VTEX envia uma autoriza&#xE7;&#xE3;o para despachar o respectivo pedido no Seller (2 fase coomited) - endpoint do Seller.</p>
<p>endpoint: <code>https://Sellerendpoint/pvt/orders/[orderid]/fulfill?sc=[idcanal]&amp;an=[mechantname]</code><br>
verb: <strong>POST</strong><br>
Content-Type: <strong>application/json</strong><br>
Accept: <strong>application/json</strong><br></p>
<p><em>request:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;marketplaceOrderId&quot;</span>: <span class="hljs-string">&quot;959311095&quot;</span> <span class="hljs-comment">// identificador do pedido originado no Marketplace</span>
}
</code></pre>
<p><em>response:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;date&quot;</span>: <span class="hljs-string">&quot;2014-10-06 18:52:00&quot;</span>,
    <span class="hljs-string">&quot;marketplaceOrderId&quot;</span>: <span class="hljs-string">&quot;959311095&quot;</span>,
    <span class="hljs-string">&quot;orderId&quot;</span>: <span class="hljs-string">&quot;123543123&quot;</span>,
    <span class="hljs-string">&quot;receipt&quot;</span>: <span class="hljs-string">&quot;e39d05f9-0c54-4469-a626-8bb5cff169f8&quot;</span>,
}
</code></pre>
<blockquote>
<p>PAGAMENTO NEGADO NO SELLER</p>
<blockquote>
<p>Enviar na URL ass&#xED;ncrona de retorno o POST com o status &quot;denied&quot;, pagamento negado. :(</p>
</blockquote>
</blockquote>
<p><a name="a81"><a></a></a></p>
<h3 id="enviar-solicita%C3%A7%C3%A3o-de-cancelamento-de-pedido"><a name="enviar-solicita%C3%A7%C3%A3o-de-cancelamento-de-pedido" class="plugin-anchor" href="#enviar-solicita%C3%A7%C3%A3o-de-cancelamento-de-pedido"><span class="fa fa-link"></span></a>Enviar Solicita&#xE7;&#xE3;o de Cancelamento de pedido</h3>
<p>Quando o pagamento do pedido &#xE9; negado no Seller, um POST dever&#xE1; ser feito na &quot;callbackUrl&quot; do pagamento, informando n&#xE3;o sucesso do pagamento (&quot;status&quot;:&quot;denied&quot;), nesse momento o Marketplace hospedado na VTEX envia uma solicita&#xE7;&#xE3;o de cancelamento do respectivo pedido no Seller - endpoint do Seller.</p>
<p>endpoint: <code>https://Sellerendpoint/pvt/orders/[orderid]/cancel?sc=[idcanal]&amp;an=[mechantname]</code><br>
verb: <strong>POST</strong><br>
Content-Type: <strong>application/json</strong><br>
Accept: <strong>application/json</strong><br></p>
<p><em>request:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;marketplaceOrderId&quot;</span>: <span class="hljs-string">&quot;959311095&quot;</span> <span class="hljs-comment">// identificador do pedido originado no Marketplace</span>
}
</code></pre>
<p><em>response:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;date&quot;</span>: <span class="hljs-string">&quot;2014-10-06 18:52:00&quot;</span>,
    <span class="hljs-string">&quot;marketplaceOrderId&quot;</span>: <span class="hljs-string">&quot;959311095&quot;</span>,
    <span class="hljs-string">&quot;orderId&quot;</span>: <span class="hljs-string">&quot;123543123&quot;</span>,
    <span class="hljs-string">&quot;receipt&quot;</span>: <span class="hljs-string">&quot;e39d05f9-0c54-4469-a626-8bb5cff169f8&quot;</span>,
}
</code></pre>
<h2 id="invocando-marketplace-services-endpoint-actions"><a name="invocando-marketplace-services-endpoint-actions" class="plugin-anchor" href="#invocando-marketplace-services-endpoint-actions"><span class="fa fa-link"></span></a>Invocando Marketplace Services Endpoint Actions</h2>
<p>O MarketplaceServicesEndpoint serve para receber informa&#xE7;&#xF5;es do Seller referentes a nota fiscal e rastreamento de entrega de pedido. &#xC9; permitido o envio de notas fiscais parciais, obrigando assim ao informador informar al&#xE9;m dos valores da nota fiscal, os items ele est&#xE1; mandando na nota fiscal parcial. O pedido na VTEX s&#xF3; andar&#xE1; pra o status FATURADO quando o valor total de todas as notas fiscais de um pedido forem enviadas.</p>
<p><a name="a10"><a></a></a></p>
<h3 id="informar-dados-de-nota-fiscal"><a name="informar-dados-de-nota-fiscal" class="plugin-anchor" href="#informar-dados-de-nota-fiscal"><span class="fa fa-link"></span></a>Informar Dados de Nota Fiscal</h3>
<p>Quando o Seller emitir a nota fiscal, deve enviar as informa&#xE7;&#xF5;es da nota fiscal - endpoint palataforma VTEX.</p>
<p>endpoint: <code>https://marketplaceServicesEndpoint/pub/orders/[marketplaceorderId]/invoice</code>
verb: <strong>POST</strong><br>
Content-Type: <strong>application/json</strong><br>
Accept: <strong>application/json</strong><br>
Parametro: <strong>marketplaceorderId</strong> // identificador do pedido no Marketplace<br></p>
<p><em>request:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;Output&quot;</span>, <span class="hljs-comment">// Output|Input (venda|devolu&#xE7;&#xE3;o)</span>
    <span class="hljs-string">&quot;invoiceNumber&quot;</span>: <span class="hljs-string">&quot;NFe-00001&quot;</span>, <span class="hljs-comment">// numero da nota fiscal</span>
    <span class="hljs-string">&quot;courier&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// quando &#xE9; nota fiscal, dados de tracking vem vazio</span>
    <span class="hljs-string">&quot;trackingNumber&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// quando &#xE9; nota fiscal, dados de tracking vem vazio</span>
    <span class="hljs-string">&quot;trackingUrl&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<span class="hljs-comment">// quando &#xE9; nota fiscal, dados de tracking vem vazio</span>
    <span class="hljs-string">&quot;items&quot;</span>: [ <span class="hljs-comment">// itens da nota</span>
      {
        <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;345117&quot;</span>,
        <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">9003</span>
      }
    ],
    <span class="hljs-string">&quot;issuanceDate&quot;</span>: <span class="hljs-string">&quot;2013-11-21T00:00:00&quot;</span>, <span class="hljs-comment">// data de emissao da nota</span>
    <span class="hljs-string">&quot;invoiceValue&quot;</span>: <span class="hljs-number">9508</span> <span class="hljs-comment">// valor da nota</span>
}
</code></pre>
<p><em>response:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;date&quot;</span>: <span class="hljs-string">&quot;2014-02-07T15:22:56.7612218-02:00&quot;</span>, <span class="hljs-comment">// data do recibo</span>
    <span class="hljs-string">&quot;orderId&quot;</span>: <span class="hljs-string">&quot;123543123&quot;</span>,
    <span class="hljs-string">&quot;receipt&quot;</span>: <span class="hljs-string">&quot;38e0e47da2934847b489216d208cfd91&quot;</span> <span class="hljs-comment">// protocolo gerado, pode ser nulo</span>
}
</code></pre>
<p><a name="a11"><a></a></a></p>
<h3 id="informar-rastreamento-de-entrega"><a name="informar-rastreamento-de-entrega" class="plugin-anchor" href="#informar-rastreamento-de-entrega"><span class="fa fa-link"></span></a>Informar Rastreamento de Entrega</h3>
<p>Quando o Seller entregar o pedido para a transportadora, deve informar as informa&#xE7;&#xF5;es de rastreamento - endpoint plataforma VTEX.</p>
<p>endpoint: <code>https://marketplaceServicesEndpoint/pub/orders/[marketplaceorderId]/invoice</code><br>
verb: <strong>POST</strong><br>
Content-Type: <strong>application/json</strong><br>
Accept: <strong>application/json</strong><br></p>
<p><em>request:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;Output&quot;</span>,
    <span class="hljs-string">&quot;invoiceNumber&quot;</span>: <span class="hljs-string">&quot;NFe-00001&quot;</span>,
    <span class="hljs-string">&quot;courier&quot;</span>: <span class="hljs-string">&quot;Correios&quot;</span>, <span class="hljs-comment">// transportadora</span>
    <span class="hljs-string">&quot;trackingNumber&quot;</span>: <span class="hljs-string">&quot;SR000987654321&quot;</span>, <span class="hljs-comment">// identificador de rastreamentor</span>
    <span class="hljs-string">&quot;trackingUrl&quot;</span>: <span class="hljs-string">&quot;http://traking.correios.com.br/sedex/SR000987654321&quot;</span>, <span class="hljs-comment">// url de rastreamento</span>
    <span class="hljs-string">&quot;items&quot;</span>: [
      {
        <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;345117&quot;</span>,
        <span class="hljs-string">&quot;quantity&quot;</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">&quot;price&quot;</span>: <span class="hljs-number">9003</span>
      }
    ],
    <span class="hljs-string">&quot;issuanceDate&quot;</span>: <span class="hljs-string">&quot;2013-11-21T00:00:00&quot;</span>, <span class="hljs-comment">// formato esperado</span>
    <span class="hljs-string">&quot;invoiceValue&quot;</span>: <span class="hljs-number">9508</span>
}
</code></pre>
<p><em>response:</em></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;date&quot;</span>: <span class="hljs-string">&quot;2014-02-07T15:22:56.7612218-02:00&quot;</span>, <span class="hljs-comment">// data do recebimento</span>
    <span class="hljs-string">&quot;orderId&quot;</span>: <span class="hljs-string">&quot;123543123&quot;</span>,
    <span class="hljs-string">&quot;receipt&quot;</span>: <span class="hljs-string">&quot;38e0e47da2934847b489216d208cfd91&quot;</span> <span class="hljs-comment">// protocolo gerado confirmando o recebimento do POST (GUID)</span>
}
</code></pre>
<blockquote>
<p>A Nota Fiscal e o Tracking de rastreamento podem ser enviados na mesma chamada, basta preencher todos os dados do POST.</p>
</blockquote>
<p><a name="a12"><a></a></a></p>
<h3 id="enviar-solicita%C3%A7%C3%A3o-de-cancelamento"><a name="enviar-solicita%C3%A7%C3%A3o-de-cancelamento" class="plugin-anchor" href="#enviar-solicita%C3%A7%C3%A3o-de-cancelamento"><span class="fa fa-link"></span></a>Enviar Solicita&#xE7;&#xE3;o de Cancelamento</h3>
<p>Uma solicita&#xE7;&#xE3;o de cancelamento pode ser enviada, caso o pedido se encontre em um estado que se permita cancelar, o pedido ser&#xE1; cancelado - endpoint palataforma VTEX.</p>
<p>endpoint: <code>https://marketplaceServicesEndpoint/pvt/orders/[marketplaceorderId]/cancel</code><br>
verb: <strong>GET</strong><br></p>
<blockquote>
<p>Para cancelar um pedido com nota fiscal j&#xE1; informada, enviar uma Nota Fiscal do tipo Input com o valor cheio do pedido.</p>
</blockquote>
<hr>
<p>Autor: <em>Jonas Bolognim</em><br>
Propriedade: <em>VTEX</em> &#xA9;<br></p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../../integracao/marketplace/seller-não-vtex/index.html" class="navigation navigation-prev " aria-label="Previous page: Seller não VTEX"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../../integracao/marketplace/vtex-marketplace-switch/index.html" class="navigation navigation-next " aria-label="Next page: VTEX Marketplace Switch - Beta"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../../gitbook/app.js"></script>

    
    <script src="../../../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="../../../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"ga":{"token":"UA-43760863-11","configuration":"auto"}};
    gitbook.start(config);
});
</script>

        <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-43760863-11', 'auto');ga('send', 'pageview');</script>
<!-- body:end -->
    </body>
    <!-- End of book VTEX Lab Docs -->
</html>
